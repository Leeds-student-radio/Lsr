<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ON AIR</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>



 



    <div class="container">
        <div class="stars">
            <span class="star" style="top: 10%; left: 10%;"></span>
            <span class="star" style="top: 25%; left: 5%;"></span>
            <span class="star" style="top: 40%; left: 12%;"></span>
            <span class="star" style="top: 15%; right: 10%;"></span>
            <span class="star" style="top: 30%; right: 5%;"></span>
            <span class="star" style="top: 50%; right: 15%;"></span>
        </div>
        <h1 class="on-air">ON AIR</h1>
        
         <div class="pill-banner" id="pillBanner">
   
      <div class="pill-content">
      <!-- TOP ROW -->
      <div class="pill-top-row">
         <h2 style="color:white; line-height:1px;" class="pill-title">Show Title</h2>
         
         
         
         
   
       
       
      </div>

     
    </div>
         
     
    
    
      <div class="image" >
    
  <img src="https://stepzach.github.io//leedstestradio/ab6765630000ba8a51445deb0fe8b8c4b173e6a1.jpeg" class="thumbnail">
        </div></div>
        <div class="bottom-section">
            <div class="listen-live box">LISTEN LIVE ON <br> WWW.THISISLSR.COM</div>
            <div class="up-next box">UP NEXT:   <span class="pill-title">The Baumnt Hour</span></div>
        </div>
    </div>
</body>
</html>
<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    overflow: hidden; /* Hide overflowing stars */
}

.container {
    position: relative;
    width: 100vw; /* Full viewport width */
    height: 100vh; /* Full viewport height */
    background-color: #d82c2c; /* Red background */
    display: flex;
    flex-direction: column;
    justify-content: space-between; /* This is the key change */
    align-items: center;
    padding: 20px;
    box-sizing: border-box;
    overflow: hidden;
}

.stars {
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
}

.star {
    position: absolute;
    width: 20px;
    height: 20px;
    background-color: white;
    clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
    transform: rotate(20deg); /* Adjust rotation for varied star look */
    z-index: 1;
}


.on-air {
    /* Use clamp for responsive but bounded font size */
    font-size: clamp(2.5rem, 7vw, 6rem); 
    color: white;
    text-shadow: 5px 5px 0px rgba(0, 0, 0, 0.3);
    text-align: center;
    letter-spacing: 0.1em;
    font-weight: bold;
    line-height:1px;
    /* Removed margins to let flexbox handle spacing */
}

.image {
    background-color: white; /* Placeholder background */
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    
    /* --- UPDATED FOR 100vh FIT --- */
    width: auto; /* Let max-width/height control size */
    max-width: 60vw; /* Max width is 60% of viewport width */
    max-height: 50vh; /* Max height is 50% of viewport height */
    aspect-ratio: 1/1; /* This will create a square that fits the constraints */
    /* Removed margin-bottom */
    /* --- END UPDATE --- */
}

.image img {
    width: 100%;
    height: 100%;
    display: block;
    object-fit: cover; /* Prevents stretching */
}

.bottom-section {
    display: flex;
    justify-content: space-between;
    width: 100%;
    padding: 0 20px; /* Adjust padding to match the image */
    box-sizing: border-box;
    /* Removed margin-bottom */
}

.box {
    background-color: white;
    color: black;
    padding: 1vw 2vw; /* Responsive padding */
    /* Use clamp for responsive but bounded font size */
    font-size: clamp(0.75rem, 1.2vw, 1.1rem);
    text-align: center;
    flex: 0 1 auto; /* Allow items to shrink but not grow excessively */
    white-space: nowrap; /* Prevent text wrapping for single lines */
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    min-width: 150px; /* Minimum width for the boxes */
}

.listen-live {
    text-align: left;
    line-height: 1.2;
}

.up-next {
    text-align: right;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .on-air {
        font-size: clamp(2rem, 12vw, 3.5rem);
    }

    .box {
        font-size: clamp(0.8rem, 2vw, 1.2rem);
        padding: 1.5vw 3vw;
    }
}

@media (max-width: 480px) {
    .on-air {
        font-size: clamp(2rem, 15vw, 3rem);
    }

    .bottom-section {
        flex-direction: column;
        align-items: center;
        gap: 10px; /* Space between boxes when stacked */
    }

    .box {
        width: 80%; /* Make boxes wider when stacked */
        font-size: clamp(0.8rem, 3.5vw, 1.1rem);
        padding: 2vw 4vw;
        white-space: normal; /* Allow wrapping on mobile */
    }
}

</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
/** ====== Config ====== **/
const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRoXcefXiUOFuRnA6DpheBwR2CJ4Zs09o68IG9in3w2WwncXybxsbVDWwQY6u6MSpmFDiRrx83MO8M3/pub?output=csv"; // change to your published CSV link
const A_IS_EVEN_ISO_WEEK = true;

const FALLBACK_SHOW = {
  title: "No Show Live",
  description: "We're currently off air. Stay tuned for the next broadcast.",
  cover_image_url: "https://stepzach.github.io//leedstestradio/ab6765630000ba8a51445deb0fe8b8c4b173e6a1.jpeg"
};

const FALLBACK_NEXT = {
  title: "No Show Scheduled",
  description: "No upcoming shows are scheduled at the moment.",
  cover_image_url: "https://stepzach.github.io//leedstestradio/ab6765630000ba8a51445deb0fe8b8c4b173e6a1.jpeg"
};

/** ====== Helpers ====== **/
function isoWeekNumber(d) {
  const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
  const dayNum = (date.getUTCDay() + 6) % 7;
  date.setUTCDate(date.getUTCDate() + 3 - dayNum);
  const firstThursday = new Date(Date.UTC(date.getUTCFullYear(), 0, 4));
  const diff = date - firstThursday;
  return 1 + Math.round(diff / (7 * 24 * 3600 * 1000));
}

function getWeekTypeAB(date) {
  const wk = isoWeekNumber(date);
  const isEven = wk % 2 === 0;
  return (A_IS_EVEN_ISO_WEEK ? (isEven ? "A" : "B") : (isEven ? "B" : "A"));
}

function timeToMinutes(t) {
  if (!t) return NaN;
  const [h, m] = t.trim().split(":").map(Number);
  return h * 60 + (m || 0);
}

function currentDayTokens(date) {
  const long = date.toLocaleString("en-GB", { weekday: "long" });
  const short = long.slice(0, 3);
  const dayIndex = (date.getDay() + 6) % 7;
  const isWeekday = dayIndex <= 4;
  return { long, short, isWeekday };
}

function matchesDay(showDayRaw, date) {
  if (!showDayRaw) return false;
  const val = String(showDayRaw).trim().toLowerCase();
  const { long, short, isWeekday } = currentDayTokens(date);
  const longL = long.toLowerCase();
  const shortL = short.toLowerCase();
  if (val === longL || val === shortL) return true;
  if (val === "daily" || val === "every day") return true;
  if (["weekday", "weekdays", "every weekday", "mon-fri", "m-f"].includes(val)) {
    return isWeekday;
  }
  if (["weekend", "weekends", "sat-sun"].includes(val)) {
    return !isWeekday;
  }
  return false;
}

function withinSlot(nowMin, startMin, endMin) {
  if (isNaN(startMin) || isNaN(endMin)) return false;
  if (startMin <= endMin) {
    return nowMin >= startMin && nowMin < endMin;
  } else {
    return nowMin >= startMin || nowMin < endMin;
  }
}

function applyShowToSection(sectionSelector, show, labelText, isLive, labelSelector = ".on-air") {
  const section = document.querySelector(sectionSelector);
  if (!section) return;
  const titleElem = section.querySelector(".pill-title");
  const descElem = section.querySelector(".pill-description");
  const imgElem = section.querySelector(".thumbnail");

  const title = show.title || show["Title"];
  const desc = show.description || show["Description"];
  const img = show.cover_image_url || show["cover image url"] || show["Cover Image Url"] || show["Cover Image URL"];

  if (titleElem) titleElem.textContent = title;
  if (descElem) descElem.firstChild ? descElem.firstChild.textContent = desc : descElem.textContent = desc;
  if (imgElem) imgElem.src = img;

  const labelElem = section.querySelector(labelSelector);
  if (labelElem) {
    if (isLive) {
      labelElem.innerHTML = `<span class="pulse-dot"></span>${labelText}`;
    } else {
      labelElem.textContent = labelText;
    }
  }

  // Special: Update description toggle fullText for first banner
  if (sectionSelector === "#pillBanner") {
    setBannerDescription(desc);
  }
}

 function nowInLondon() {
  // Returns a Date object that represents the *current London local time*,
  // automatically adjusting for British Summer Time (BST)
  const formatter = new Intl.DateTimeFormat('en-GB', {
    timeZone: 'Europe/London',
    year: 'numeric',
    month: '2-digit',
    day: '2-digit',
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit'
  });

  const parts = formatter.formatToParts(new Date());
  const get = t => parseInt(parts.find(p => p.type === t)?.value || 0, 10);

  return new Date(
    get('year'),
    get('month') - 1,
    get('day'),
    get('hour'),
    get('minute'),
    get('second')
  );
}

function normalizeRows(rows) {
  return rows.map(r => {
    const o = {};
    Object.keys(r).forEach(k => {
      o[k.trim().toLowerCase().replace(/\s+/g, '_')] = (r[k] ?? "").toString().trim();
    });
    return o;
  });
}

function findCurrentShow(rows) {
const now = nowInLondon();

  const nowMinutes = now.getHours() * 60 + now.getMinutes();
  const weekType = getWeekTypeAB(now);
  return rows.find(show => {
    const dayOK = matchesDay(show.day_of_week, now);
    if (!dayOK) return false;
    const wt = (show.week_type || "").toUpperCase();
    const weekOK = !wt || wt === "*" || wt === "ALL" || wt === weekType;
    if (!weekOK) return false;
    return withinSlot(nowMinutes, timeToMinutes(show.start_time), timeToMinutes(show.end_time));
  });
}

function findNextShow(rows) {
const now = nowInLondon();

  const nowMinutes = now.getHours() * 60 + now.getMinutes();
  const weekType = getWeekTypeAB(now);
  const candidates = rows.filter(show => {
    const dayOK = matchesDay(show.day_of_week, now);
    if (!dayOK) return false;
    const wt = (show.week_type || "").toUpperCase();
    const weekOK = !wt || wt === "*" || wt === "ALL" || wt === weekType;
    if (!weekOK) return false;
    return timeToMinutes(show.start_time) > nowMinutes;
  }).sort((a, b) => timeToMinutes(a.start_time) - timeToMinutes(b.start_time));
  return candidates[0] || null;
}
  
/** ====== Description Toggle for Banner 1 ====== **/
const description = document.getElementById('pillDescription');
const toggleBtn = document.getElementById('toggleDescription');

let expanded = false;
let fullText = (description.textContent || '').trim();

// Ensure there's a leading text node before the button
let textNode = description.firstChild;
if (!textNode || textNode.nodeType !== Node.TEXT_NODE) {
  textNode = document.createTextNode('');
  description.insertBefore(textNode, toggleBtn || null);
}

// Hidden measurer that copies the description's font styles
const measurer = document.createElement('span');
Object.assign(measurer.style, {
  position: 'absolute',
  visibility: 'hidden',
  whiteSpace: 'nowrap',
  top: '-9999px',
  left: '-9999px'
});
document.body.appendChild(measurer);

function textWidth(str) {
  const cs = getComputedStyle(description);
  measurer.style.font = cs.font;
  measurer.style.letterSpacing = cs.letterSpacing;
  measurer.style.textTransform = cs.textTransform;
  measurer.textContent = str;
  return measurer.getBoundingClientRect().width;
}

function truncateToPixelWidth(text, maxPx) {
  if (textWidth(text) <= maxPx) {
    return { text, cut: false };
  }
  // Binary search for longest prefix that fits with "..."
  let lo = 0, hi = text.length, best = '...';
  while (lo <= hi) {
    const mid = (lo + hi) >> 1;
    const candidate = text.slice(0, mid).trimEnd() + '...';
    if (textWidth(candidate) <= maxPx) {
      best = candidate;
      lo = mid + 1;
    } else {
      hi = mid - 1;
    }
  }
  return { text: best, cut: true };
}

function updateDescription() {
  // Choose limit based on screen size
  const maxWidthPx = window.innerWidth <= 600 ? 320 : 900;

  if (!expanded) {
    const { text, cut } = truncateToPixelWidth(fullText, maxWidthPx);
    textNode.textContent = text;
    if (cut) {
      toggleBtn.textContent = ' More';
      toggleBtn.style.display = 'inline';
      toggleBtn.setAttribute('aria-hidden', 'false');
    } else {
      toggleBtn.textContent = '';
      toggleBtn.style.display = 'none';
      toggleBtn.setAttribute('aria-hidden', 'true');
    }
  } else {
    textNode.textContent = fullText;
    const wasTruncated = textWidth(fullText) > maxWidthPx;
    toggleBtn.textContent = wasTruncated ? ' Less' : '';
    toggleBtn.style.display = wasTruncated ? 'inline' : 'none';
    toggleBtn.setAttribute('aria-hidden', wasTruncated ? 'false' : 'true');
  }
}

toggleBtn.addEventListener('click', () => {
  expanded = !expanded;
  toggleBtn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
  updateDescription();
});

window.addEventListener('resize', updateDescription);

function setBannerDescription(newText) {
  fullText = (newText || '').trim();
  expanded = false;
  updateDescription();
}

// Initial render
updateDescription();

function applyShowToPlayer(sectionSelector, show, isLive) {
  const section = document.querySelector(sectionSelector);
  if (!section) return;

  const titleElem = section.querySelector(".player-title");
  const descElem = section.querySelector(".player-description");
  const imgElem = section.querySelector(".album-cover img");

  const title = show.title || show["Title"];
  const desc = show.description || show["Description"];
  const img = show.cover_image_url || show["cover image url"] || show["Cover Image Url"] || show["Cover Image URL"];

  if (titleElem) titleElem.textContent = title;
  if (descElem) descElem.textContent = desc;
  if (imgElem) imgElem.src = img;

  // Optional: Add "On Air" indicator somewhere in the player if needed
  if (isLive) {
    section.classList.add("on-air");
  } else {
    section.classList.remove("on-air");
  }

   // Media Session API (lock-screen title + artwork)
  if ('mediaSession' in navigator) {
    navigator.mediaSession.metadata = new MediaMetadata({
      title: title,
      artist: 'Leeds Student Radio',
      album: '',
      artwork: [
        { src: img, sizes: '96x96',   type: 'image/jpeg' },
        { src: img, sizes: '128x128', type: 'image/jpeg' },
        { src: img, sizes: '256x256', type: 'image/jpeg' },
        { src: img, sizes: '512x512', type: 'image/jpeg' }
      ]
    });

    navigator.mediaSession.setActionHandler('play', () => audio.play());
    navigator.mediaSession.setActionHandler('pause', () => audio.pause());
  }

}

/** ====== Fetch + Update ====== **/
function fetchAndUpdate() {
  Papa.parse(SHEET_CSV_URL, {
    download: true,
    header: true,
    skipEmptyLines: "greedy",
    complete: function(res) {
      if (!res || !res.data || !res.data.length) return;
      const rows = normalizeRows(res.data);

      // First banner (original)
      const current1 = findCurrentShow(rows);
      if (current1) {
        applyShowToSection("#pillBanner", current1, "", true);
      } else {
          applyShowToSection("#pillBanner", FALLBACK_SHOW, "Off Air", false);
      }

      // Second banner (current + up next)
      const current2 = current1 || findCurrentShow(rows);
      if (current2) {
        applyShowToSection("#pillBanner1 .current-show", current2, "On Air", true, ".on-air");
      } else {
      applyShowToSection("#pillBanner1 .current-show", FALLBACK_SHOW, "Off Air", false, ".on-air");
      }

      const next = findNextShow(rows);
      if (next) {
        applyShowToSection("#pillBanner1 .up-next", next, "⏳ Up Next", false, ".up-next-label");
      } else {
        applyShowToSection("#pillBanner1 .up-next", FALLBACK_NEXT, "⏳ Up Next", false, ".up-next-label");
      }
      if (current1) {
        applyShowToPlayer(".playerzz .main-player", current1, true);
      } else {
        applyShowToPlayer(".playerzz .main-player", FALLBACK_SHOW, false);
      }
    }
  });
}

fetchAndUpdate();
setInterval(fetchAndUpdate, 60000);


 
</script>


<script>
  // Set --vh to the initial viewport height and don't update it again
  (function () {
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
  })();
const menuButton = document.getElementById("menuButton");
const slidingMenu = document.getElementById("slidingMenu");
const overlay = document.querySelector(".title");
const menu = document.querySelector(".menu");
const projectsHover = document.getElementById("projectsHover");
const nav = document.querySelector(".desktop-nav"); 
const nav2 = document.querySelector(".nav-item");

let menuOpen = false;

// MOBILE: Click menu toggle
menuButton.addEventListener("click", () => {
  menuOpen = !menuOpen;

  if (menuOpen) {
    slidingMenu.classList.add("open");
    menuButton.innerHTML = '<span style="display:block; padding-top:5px; padding-left:4px; font-size: 2.2rem;">✕</span>';

    setTimeout(() => {
      overlay.classList.add("menu-open");
      menu.classList.add("menu-open");
    
    }, 50);
  } else {
    slidingMenu.classList.remove("open");
    menuButton.textContent = "☰";

    setTimeout(() => {
      overlay.classList.remove("menu-open");
      menu.classList.remove("menu-open");
    }, 1000);
  }
});

// DESKTOP: Hover to show/hide menu with class-based control
if (window.innerWidth >= 768 && projectsHover) {
  let hoverTimeout;

  const openMenu = () => {
    slidingMenu.classList.add("open");
     setTimeout(() => {
    overlay.classList.add("menu-open");
    menu.classList.add("menu-open");
      nav.classList.add("item-open");
       nav2.classList.add("item-open");
       }, 50);
  };

  const closeMenu = () => {
    slidingMenu.classList.remove("open");
    setTimeout(() => {
    overlay.classList.remove("menu-open");
    menu.classList.remove("menu-open");
     nav.classList.remove("item-open");
     nav2.classList.remove("item-open");
       }, 1000);
  
  };

  projectsHover.addEventListener("mouseenter", () => {
    clearTimeout(hoverTimeout);
    openMenu();
  });

  projectsHover.addEventListener("mouseleave", () => {
    hoverTimeout = setTimeout(() => {
      if (!slidingMenu.matches(":hover")) {
        closeMenu();
      }
    }, 200);
  });

  slidingMenu.addEventListener("mouseenter", () => {
    clearTimeout(hoverTimeout);
    openMenu();
  });

  slidingMenu.addEventListener("mouseleave", () => {
    closeMenu();
  });
}
// TOUCH DEVICE: Click to toggle menu on #projectsHover
if ('ontouchstart' in window && projectsHover) {
  let touchMenuOpen = false;

  projectsHover.addEventListener("click", () => {
    touchMenuOpen = !touchMenuOpen;

    if (touchMenuOpen) {
      slidingMenu.classList.add("open");
      overlay.classList.add("menu-open");
      menu.classList.add("menu-open");
    } else {
      slidingMenu.classList.remove("open");
      overlay.classList.remove("menu-open");
      menu.classList.remove("menu-open");
    }
  });
}

// On window resize: reset to default state if switching to desktop
window.addEventListener('resize', () => {
  if (window.innerWidth >= 768) {
    menuButton.textContent = "☰";
    slidingMenu.classList.remove("open");
    overlay.classList.remove("menu-open");
    menu.classList.remove("menu-open");
     nav.classList.remove("item-open");
     nav2.classList.remove("item-open");
    menuOpen = false;
  }
});

  const pillContainer = document.getElementById("pillContainer");
  const tabs = document.querySelectorAll(".tab");

  const pillData = {
  
   featured: [
     
      
    
     
      ],
    
    
    
    university: [
     { title: "LIBRARY LIVE SEATING MAP", caption: "Service Design Project", img: "https://github.com/Stepzach/DesignPortfolio/blob/main/Image%2060.png?raw=true",
       link: "https://github.com/Stepzach/DesignPortfolio/blob/main/ServiceDesignPORTFOLIO.pdf",
       },
      
      { title: "SMART SECURITY SYSTEM INTERFACE", caption: "Electronics Project on Arduino", img: "https://github.com/Stepzach/DesignPortfolio/blob/main/IMG_5700-min.jpeg?raw=true",
       link: "https://zacharystephens.info/Washing-Project1elec.pdf",
       tags: [
        { text: "C++", color: "#67645e" }
       
      ]}, 
      
       { title: "PRESENTATION TO TAIT TOWERS", caption: "Solution proposition, after visiting their warehouse", img: "https://github.com/Stepzach/DesignPortfolio/blob/main/IMG_5702-min.jpeg?raw=true",
         link: "https://zacharystephens.info/TaitPresentation.pdf",
      tags: [
        { type: "logo", src: "https://media.licdn.com/dms/image/v2/D4E0BAQGAOMFDbRl8Mg/company-logo_200_200/company-logo_200_200/0/1719258433497/tait_towers_logo?e=2147483647&v=beta&t=pgXn4jQw1VTtbaURo8v_wFdrSyvFEl3Y2dZ57YDZvvk" }
      ]},
     
    ],
    website: [
      { title: "BAD B!TCH DUBZ", caption: "Women-led record label and DJ collective based in Bristol", img: "https://ugc.production.linktr.ee/c3af7b23-afcc-4093-94fe-a56bf3d5b691_IMG-9572.jpeg?io=true&size=avatar-v3_0",  link: "https://badbitchdubz.co.uk/", },
      
       
      { title: "LEEDS STUDENTS RADIO", caption: "Officially the UK's best student radio 2023 & 2024",  link: "https://www.thisislsr.com/",
      img: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAMAAABF0y+mAAAAdVBMVEW2DQW1AACyAACzAAC2CwC0AAC/Pjzqy8rkv77boaDy3d3YmZfeqajoxcTjt7bKa2mxAADDUE7////04+P8+vnPf33Wj47ShoWuAADhsbDNeni8Mi/Uionv19bdp6e4HhnHYF7BSke5JCD47e3Kc3HEVlPHYmDqAzGvAAABCElEQVR4Ac3QBYLDIBAFUBgycRr641rv/Y+4Q5W9QX8UHq5+L5rM8ycyRCZSypB8+WlxkpqnZXleUGRKa+2ucg/cA84b1ZDU5B5flPTExiO3QFcA/ZBjnHbArL9IKUY3WFjB3slr4QATZIb7NfPIZLGZAHewAzMZ59ElKALkCsgnYiU4DQfgGAyraAPQTEawaYDaqQAVzaPwSRBiFIUov0Q1/IKmM5r/SI4VlUgF++GCigOk9XJl80I3IqUXDkTkVmzDIJv1SDeAogdiXdc87gCbAPvnPhsZ94k+RycCjP7gF6YUiYwbzd0i6Wbt7uV2c4qn7qR13MnZivIjMgMbo5V8WN6axX4uf1gvFqo3LKsUAAAAAElFTkSuQmCC" },
      { title: "THE GRYPHON", 
      caption: "The Official Newspaper of the University of Leeds, since 1897", 
       link: "https://www.thegryphon.co.uk/",
       img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT3sEAGHRuuR_Qd1LrYE7lBrKF4iLZicloVOA&s" },
     
    ],
    personal: [
      { title: "MINI CROSSWORD GAME", 
      caption: "5x5 Crossword with leaderboard", 
      img: "https://github.com/Stepzach/DesignPortfolio/blob/main/IMG_5703-min.jpeg?raw=true", 
       link: "https://zacharystephens.info/nytmini.pdf",
        tags: [
        { text: "JS", color: "#67645e" }
      ]},
      
      { title: "CIRCULAR PIZZA BOX", 
      caption: "Prototyping experiment",  
      link: "https://zacharystephens.info/pizza.pdf", 
      img: "https://github.com/Stepzach/DesignPortfolio/blob/main/IMG_5704-min.jpeg?raw=true" },
      
      { title: "LOGO DESIGNS",  
      link: "https://zacharystephens.info/logodes.pdf", 
      caption: "For various Uni of Leeds societies", 
      img: "https://github.com/Stepzach/DesignPortfolio/blob/main/IMG_5705-min.jpeg?raw=true" },
      
      { title: "MENU RE-DESIGN", 
      caption: "For Okan (a Japanese restaurant I used to work at)", 
      link: "https://zacharystephens.info/menuokan.pdf", 
      img: "https://github.com/Stepzach/DesignPortfolio/blob/main/IMG_5707-min.jpeg?raw=true" }
    
    ]
  };

function renderPills(category) {
  const oldPills = pillContainer.querySelectorAll('.pill');

  // If there are pills already, fade them out first
  if (oldPills.length > 0) {
    oldPills.forEach(pill => pill.classList.remove('show'));
    oldPills.forEach(pill => pill.classList.add('hide'));

    // Wait for fade-out to finish before replacing
    setTimeout(() => {
      showNewPills(category);
    }, 400); // Match CSS transition duration
  } else {
    showNewPills(category);
  }
}

function showNewPills(category) {
  pillContainer.innerHTML = pillData[category].map((pill, index) => `
    <a href="${pill.link}" class="pill-link" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">
      <div class="pill" data-index="${index}">
        <div class="pill-tags">
          ${(pill.tags || []).map(tag => {
            if (tag.type === "logo") {
              return `<img class="pill-logo" src="${tag.src}" alt="logo" />`;
            } else {
              return `<span class="pill-tag" style="background-color: ${tag.color || 'gray'}">${tag.text}</span>`;
            }
          }).join('')}
        </div>
        <img src="${pill.img}" alt="${pill.title}">
        <div class="pill-text">
          <h4>${pill.title}</h4>
          <p>${pill.caption}</p>
        </div>
      </div>
    </a>
  `).join('');

  // Fade in new pills
  const newPills = pillContainer.querySelectorAll('.pill');
  newPills.forEach((pill, i) => {
    setTimeout(() => {
      pill.classList.add('show');
    }, i * 100); // Optional stagger
  });
}




  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => t.classList.remove("active"));
      tab.classList.add("active");
      renderPills(tab.dataset.category);
    });
  });
function setupTabInteractions() {
  const isDesktop = window.innerWidth >= 769;

  tabs.forEach(tab => {
    // Remove any previous listeners by cloning
    const newTab = tab.cloneNode(true);
    tab.parentNode.replaceChild(newTab, tab);
  });

  const updatedTabs = document.querySelectorAll(".tab");

  updatedTabs.forEach(tab => {
    const activateTab = () => {
      updatedTabs.forEach(t => t.classList.remove("active"));
      tab.classList.add("active");
      renderPills(tab.dataset.category);
    };

    if (isDesktop) {
      tab.addEventListener("mouseenter", activateTab);
    } else {
      tab.addEventListener("click", activateTab);
    }
  });
}

// Run on load and resize
window.addEventListener("DOMContentLoaded", setupTabInteractions);
window.addEventListener("resize", setupTabInteractions);

  // Load default pills
  renderPills("featured");
  const menuTabs = document.querySelector('.menu-tabs');

  let isDown = false;
  let startX;
  let scrollLeft;

  menuTabs.addEventListener('mousedown', (e) => {
    isDown = true;
    menuTabs.classList.add('dragging');
    startX = e.pageX - menuTabs.offsetLeft;
    scrollLeft = menuTabs.scrollLeft;
  });

  menuTabs.addEventListener('mouseleave', () => {
    isDown = false;
    menuTabs.classList.remove('dragging');
  });

  menuTabs.addEventListener('mouseup', () => {
    isDown = false;
    menuTabs.classList.remove('dragging');
  });

  menuTabs.addEventListener('mousemove', (e) => {
    if (!isDown) return;
    e.preventDefault();
    const x = e.pageX - menuTabs.offsetLeft;
    const walk = (x - startX) * 2; // adjust scroll speed multiplier here
    menuTabs.scrollLeft = scrollLeft - walk;
  });
</script>

<!--<script>
document.getElementById('menuButton').addEventListener('click', () => {
  if (window.innerWidth <= 520) {
    setTimeout(() => {
      const menu = document.querySelector('.menu-tabs');
      menu.classList.add('jerk');

      // Remove the class after animation ends so it can trigger again next time
      menu.addEventListener('animationend', function handler() {
        menu.classList.remove('jerk');
        menu.removeEventListener('animationend', handler);
      });
    }, 2000); // 4 seconds
  }
});

</script>-->
<script>
  const track = document.getElementById('carouselTrack');
  const dotsContainer = document.getElementById('carouselDots');
  const cards = track.querySelectorAll('.image-card');

  // Create dots and add click listeners
  cards.forEach((_, index) => {
    const dot = document.createElement('span');
    dot.classList.add('dot');
    if (index === 0) dot.classList.add('active');
    
    dot.addEventListener('click', () => {
      const cardWidth = cards[0].offsetWidth + 20; // includes gap
      track.scrollTo({
        left: index * cardWidth,
        behavior: 'smooth'
      });
    });

    dotsContainer.appendChild(dot);
  });

  const dots = dotsContainer.querySelectorAll('.dot');

  // Update active dot on scroll
  track.addEventListener('scroll', () => {
    const scrollLeft = track.scrollLeft;
    const cardWidth = cards[0].offsetWidth + 20;
    const index = Math.round(scrollLeft / cardWidth);

    dots.forEach(dot => dot.classList.remove('active'));
    if (dots[index]) {
      dots[index].classList.add('active');
    }
  });
</script>
<script>
  document.getElementById('password-form').addEventListener('submit', function (e) {
    e.preventDefault();

    const errorMessage = document.getElementById('error-message');

    // Add the 'visible' class to fade in the error
    errorMessage.classList.add('visible');
  });
  
  const banner = document.getElementById('pillBanner');
const description = document.getElementById('pillDescription');
const toggleBtn = document.getElementById('toggleDescription');
const playBtn = document.getElementById('playBtn');

let lastScrollTop = 0;
let expanded = false;
const fullText = description.childNodes[0].textContent.trim();

function updateDescription() {
  if (window.innerWidth <= 600 && !expanded) {
    const words = fullText.split(' ');
    if (words.length > 12) {
      description.childNodes[0].textContent = words.slice(0, 12).join(' ') + '...';
      toggleBtn.textContent = 'More';
    } else {
      toggleBtn.textContent = '';
    }
  } else {
    description.childNodes[0].textContent = fullText;
    toggleBtn.textContent = expanded ? 'Less' : '';
  }
}

toggleBtn.addEventListener('click', () => {
  expanded = !expanded;
  updateDescription();
});

updateDescription();
window.addEventListener('resize', updateDescription);

// Scroll shrink effect
window.addEventListener('scroll', () => {
  const st = window.scrollY || document.documentElement.scrollTop;
  if (st > lastScrollTop + 10) {
    banner.classList.add('shrink');
  } else if (st < lastScrollTop - 10) {
    banner.classList.remove('shrink');
  }
  lastScrollTop = st <= 0 ? 0 : st;
});

// Play/Pause
let playing = false;
playBtn.addEventListener('click', () => {
  playing = !playing;
  playBtn.textContent = playing ? '⏸' : '▶';
});
document.addEventListener("DOMContentLoaded", function () {
  const pillBanner = document.querySelector(".pill-banner");
  const heroSection = document.querySelector(".hero-section");

  if (pillBanner && heroSection) {
    // Get the height of .pill-banner
    const pillHeight = pillBanner.offsetHeight;
    const extraSpace = 20; // Fixed value in px you want to add

    // Apply margin-top to .hero-section
    heroSection.style.marginTop = (pillHeight + extraSpace) + "px";
  }
});
const slides = document.querySelectorAll('.hero-img');
const prevBtn = document.querySelector('.arrow.left');
const nextBtn = document.querySelector('.arrow.right');
let current = 0;
let autoPlay = setInterval(nextSlide, 4000);

function showSlide(index) {
  slides.forEach((slide, i) => slide.classList.toggle('active', i === index));
}

function nextSlide() {
  current = (current + 1) % slides.length;
  showSlide(current);
}

function prevSlide() {
  current = (current - 1 + slides.length) % slides.length;
  showSlide(current);
}

nextBtn.addEventListener('click', () => {
  nextSlide();
  resetAutoPlay();
});

prevBtn.addEventListener('click', () => {
  prevSlide();
  resetAutoPlay();
});

function resetAutoPlay() {
  clearInterval(autoPlay);
  autoPlay = setInterval(nextSlide, 8000);
}

 
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const banners = document.querySelectorAll('.pill-banner');
  const streamUrl = "https://streamer.radio.co/s986435880/listen";
  const audio = new Audio(streamUrl);
  audio.preload = "none";

  let playing = false;
  let firstPlay = true;

  // Select all play buttons (both banners)
  const playButtons = document.querySelectorAll('.play-btn');

  // Function to update all buttons' icons at once
  function updateButtons(iconHtml) {
    playButtons.forEach(btn => {
      btn.innerHTML = iconHtml;
    });
  }

  // Initial icon
  updateButtons('<i class="fa-solid fa-play"></i>');

  // Add click event to all play buttons
  playButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      if (!playing) {
        // Start streaming immediately
        audio.play().catch(err => console.error("Playback failed:", err));

        // On first play, show spinner for 2.5 seconds
        if (firstPlay) {
          firstPlay = false;
          updateButtons('<i class="fa-solid fa-spinner fa-spin"></i>');
          setTimeout(() => {
            if (playing) {
              updateButtons('<i class="fa-solid fa-pause"></i>');
            }
          }, 2500);
        } else {
          updateButtons('<i class="fa-solid fa-pause"></i>');
        }

        playing = true;

      } else {
        // Pause audio
        audio.pause();
        playing = false;
        updateButtons('<i class="fa-solid fa-play"></i>');
      }
    });
  });

  // Reset icons when stream ends
  audio.addEventListener('ended', () => {
    playing = false;
    updateButtons('<i class="fa-solid fa-play"></i>');
  });

  // Optional: Scroll shrink effect (from your original code)
  banners.forEach(banner => {
    let lastScrollTop = 0;
    window.addEventListener('scroll', () => {
      const st = window.scrollY || document.documentElement.scrollTop;
      if (st > lastScrollTop + 10) {
        banner.classList.add('shrink');
      } else if (st < lastScrollTop - 10) {
        banner.classList.remove('shrink');
      }
      lastScrollTop = st <= 0 ? 0 : st;
    });
  });
});
</script>
